{{#partial "page"}}

    <div class="swatchCheckout swatchCheckout--order">
        <header class="swatchCheckout__header">
            <h1 class="swatchCheckout__title">Free Swatch Request</h1>
            <p class="swatchCheckout__sub"><strong>Free Ground Shipping on All Swatches.</strong> Simply enter your name, mailing address, and email to get FREE sample swatches. Swatches are free, up to 3 per customer.</p>
        </header>


        <div class="swatchCheckout__cntr">
            <div class="swatchCheckout__col swatchCheckout__col--7-10">
                <header class="swatchCheckout__itemHeader">Swatch Item</header>
                <ol class="swatchCheckout__itemList" id="swatchCheckoutItemList"></ol>
                <div class="swatchCheckout__itemEmpty hide">You currently have no swatches in your cart. &nbsp; <a href="/shop-all-brands" class="swatchCheckout__itemEmptyLink">Shop all brands &rsaquo;</a></div>
            </div>


            <div class="swatchCheckout__col swatchCheckout__col--3-10">
                <header class="swatchCheckout__itemHeader">Your Shipping Information</header>

                <form class="swatchCheckout__form form" name="swatchCheckout__form" id="swatchCheckoutForm" method="POST" action="https://hooks.zapier.com/hooks/catch/2573862/omrm3bq/">
                    <input type="hidden" name="swatchValues">
                    <input type="hidden" name="productName">
                    <input type="hidden" name="productSku">

                    <div class="form-field form-field-common  form-required">
                        <label class="form-label" for="input-first_name">
                            <span class="form-field-title">First Name</span>
                            <span class="form-field-control">
                                <input class="form-input" id="input-first_name" name="first_name" type="text" placeholder="" required aria-required="true">
                            </span>
                        </label>
                    </div>

                    <div class="form-field form-field-common  form-required">
                        <label class="form-label" for="input-last_name">
                            <span class="form-field-title">Last Name</span>
                            <span class="form-field-control">
                                <input class="form-input" id="input-last_name" name="last_name" type="text" placeholder="" required aria-required="true">
                            </span>
                        </label>
                    </div>

                    <div class="form-field form-field-common form-required">
                        <label class="form-label" for="input-email">
                            <span class="form-field-title">Email Address</span>
                            <span class="form-field-control">
                                <input class="form-input" id="input-email" name="email" type="email" placeholder="" required aria-required="true">
                            </span>
                        </label>
                    </div>


                    <div class="form-field form-field-common  form-required">
                        <label class="form-label" for="input-phone">
                            <span class="form-field-title">Phone Number (For updates on your order)</span>
                            <span class="form-field-control">
                                <input class="form-input" id="input-phone" name="phone" type="tel" placeholder="" required aria-required="true">
                            </span>
                        </label>
                    </div>


                    <div class="form-field form-field-common  form-required">
                        <label class="form-label" for="input-address">
                            <span class="form-field-title">Street Address</span>
                            <span class="form-field-control">
                                <input class="form-input" id="input-address" name="address" type="text" placeholder="" required aria-required="true">
                            </span>
                        </label>
                    </div>

                    <div class="form-field form-field-common  form-required">
                        <label class="form-label" for="nput-city">
                            <span class="form-field-title">City</span>
                            <span class="form-field-control">
                                <input class="form-input" id="input-city" name="city" type="text" placeholder="" required aria-required="true">
                            </span>
                        </label>
                    </div>

                    <div class="form-field form-field-short  form-required">
                        <label class="form-label" for="nput-last_name">
                            <span class="form-field-title">State</span>
                            <span class="form-field-control">
                                <select class="form-input" id="input-state" name="state" required aria-required="true">
                                    <option value="" selected="selected">Select a State</option>
                                    <option value="AL">Alabama</option>
                                    <option value="AK">Alaska</option>
                                    <option value="AZ">Arizona</option>
                                    <option value="AR">Arkansas</option>
                                    <option value="CA">California</option>
                                    <option value="CO">Colorado</option>
                                    <option value="CT">Connecticut</option>
                                    <option value="DE">Delaware</option>
                                    <option value="DC">District Of Columbia</option>
                                    <option value="FL">Florida</option>
                                    <option value="GA">Georgia</option>
                                    <option value="HI">Hawaii</option>
                                    <option value="ID">Idaho</option>
                                    <option value="IL">Illinois</option>
                                    <option value="IN">Indiana</option>
                                    <option value="IA">Iowa</option>
                                    <option value="KS">Kansas</option>
                                    <option value="KY">Kentucky</option>
                                    <option value="LA">Louisiana</option>
                                    <option value="ME">Maine</option>
                                    <option value="MD">Maryland</option>
                                    <option value="MA">Massachusetts</option>
                                    <option value="MI">Michigan</option>
                                    <option value="MN">Minnesota</option>
                                    <option value="MS">Mississippi</option>
                                    <option value="MO">Missouri</option>
                                    <option value="MT">Montana</option>
                                    <option value="NE">Nebraska</option>
                                    <option value="NV">Nevada</option>
                                    <option value="NH">New Hampshire</option>
                                    <option value="NJ">New Jersey</option>
                                    <option value="NM">New Mexico</option>
                                    <option value="NY">New York</option>
                                    <option value="NC">North Carolina</option>
                                    <option value="ND">North Dakota</option>
                                    <option value="OH">Ohio</option>
                                    <option value="OK">Oklahoma</option>
                                    <option value="OR">Oregon</option>
                                    <option value="PA">Pennsylvania</option>
                                    <option value="RI">Rhode Island</option>
                                    <option value="SC">South Carolina</option>
                                    <option value="SD">South Dakota</option>
                                    <option value="TN">Tennessee</option>
                                    <option value="TX">Texas</option>
                                    <option value="UT">Utah</option>
                                    <option value="VT">Vermont</option>
                                    <option value="VA">Virginia</option>
                                    <option value="WA">Washington</option>
                                    <option value="WV">West Virginia</option>
                                    <option value="WI">Wisconsin</option>
                                    <option value="WY">Wyoming</option>
                                </select>
                            </span>
                        </label>
                    </div>

                    <div class="form-field form-field-short  form-required">
                        <label class="form-label" for="nput-postal-code">
                            <span class="form-field-title">Zip Code</span>
                            <span class="form-field-control">
                                <input class="form-input" id="input-postal_code" name="postal-code" type="text" placeholder="" required aria-required="true">
                            </span>
                        </label>
                    </div>

                    <div class="form-field form-field-common">
                        <label class="form-label" for="trade-pro">
                            <input type="checkbox" name="trade-pro"> &nbsp; Are you a professional interested in our trade program?
                        </label>
                    </div>

                    <div class="form-field form-field-common form-required">
                        <button type="submit" id="sendSamplesBtn" class="swatchCheckout__submit" autocomplete="off">
                            <span class="swatchCheckout__submitText">Send my free samples</span>
                            <svg class="icon icon-spinner hide"><use xlink:href="#icon-spinner" /></svg>
                        </button>
                    </div>
                </form>

            </div>
        </div><!-- /cntr -->
    </div><!-- /swatch checkout -->


    <div class="swatchCheckout swatchCheckout--confirmation hide">
        <h2 class="swatchCheckout__title swatchCheckout__title--lg">Thank You!</h2>
        <p class="swatchCheckout__sub swatchCheckout__sub--noHighlight">You will receive a confirmation email shortly on your order.</p>
        
        <div class="swatchCheckout__cntr swatchCheckout__cntr--narrow">
            <div class="swatchCheckout__col swatchCheckout__col--5-10">
                <img class="swatchCheckout__colImg" src="https://i.shgcdn.com/f9112db0-ed0e-416c-aa6c-e05b8ab42730/-/format/auto/-/preview/3000x3000/-/quality/lighter/">
                <h2 class="swatchCheckout__title swatchCheckout__title--2">Design Services</h2>
                <p class="swatchCheckout__colTxt">Whether you are a home owner with a small project, or a residential or commercial property owner looking to create a beautiful outdoor space for residents or guests, scheduling a Free consultation with an AuthenTEAK design professional is the first step to bringing your outdoor ideas to life.</p>
                <a href="/design-services/" class="button button-secondary--darkTrans">Lean more</a>
            </div>
            <div class="swatchCheckout__col swatchCheckout__col--5-10">
                <img class="swatchCheckout__colImg" src="https://i.shgcdn.com/5f6d970f-b591-4b06-b4c9-700e98b543b4/-/format/auto/-/preview/3000x3000/-/quality/lighter/">
                <h2 class="swatchCheckout__title swatchCheckout__title--2">Free Shipping on all orders</h2>
                <p class="swatchCheckout__colTxt">Enjoy free professional shipping on every order. Full service delivery is a trademark of authenteak and we offer professional white-glove delivery services complete with in-house assembly and set-up in addition to our standard freight shipping options. <em>Some exclusions apply.</em></p>
                <a href="/featured-offers/" class="button button-secondary--darkTrans">Shop what's on Sale</a>
            </div>
        </div>
    </div>


    <div class="swatchCheckout swatchCheckout--rv">
        <section class="products-related products-recently-viewed section" id="recentlyViewedProducts">
            <div class="container">
                <h3 class="section-title">{{lang 'product.recently_viewed_products_heading'}}</h3>
                <div class="product-grid product-rv-carousel"></div>
            </div>
        </section>
    </div>


{{/partial}}

<script>
(function(window, document){
    var swatchData, sendSamplesBtn, formInput;

    document.addEventListener('DOMContentLoaded', function(){
        sendSamplesBtn = document.getElementById("sendSamplesBtn");

        if(window.sessionStorage){
            swatchData = window.sessionStorage.getItem("TEAK_requestSWatch");

            if( swatchData ){
                swatchData = JSON.parse(swatchData);
                document.swatchCheckout__form.productName.value = swatchData.product_title;
                document.swatchCheckout__form.productSku.value = swatchData.product_sku;

                parseSwatchData(swatchData);
            
            }else{
                document.querySelector(".swatchCheckout__itemEmpty").classList.remove("hide");
            }
        }

        $(document)
            .on("click", ".swatchCheckout__removeItem", removeSwatch)
            .on("click", "#sendSamplesBtn", initProgressBtn)
            .on("submit", "#swatchCheckoutForm", postToZendesk);

        
        formInput = document.querySelectorAll(".form-input");

        formInput.forEach(function(element){
            element.addEventListener('invalid', captureErr);
        });
        

    });


    function parseSwatchData(swatchData){
        let swatchColors = [];

        if( Array.isArray(swatchData.swatch_colors) ){
            swatchData.swatch_colors.forEach(function(element, i){
                swatchData.swatch_colors[i] = element = fixSwatchColorText(element);

                let tpl = buildSwatchItem(swatchData, i);
                
                $(tpl).appendTo("#swatchCheckoutItemList");
                swatchColors.push(element);
            });

        }else if( swatchData.swatch_colors !== "" ){
            swatchData.swatch_colors = fixSwatchColorText(swatchData.swatch_colors);

            let tpl = buildSwatchItem(swatchData, 0);

            $(tpl).appendTo("#swatchCheckoutItemList");
            swatchColors.push(swatchData.swatch_colors);
        }
    
        document.swatchCheckout__form.swatchValues.value = swatchColors.join(", ");

        sendSamplesBtn.removeAttribute("disabled", true);
    }



    function initProgressBtn(isShown){
        sendSamplesBtn.querySelector(".swatchCheckout__submitText").classList.toggle("hide", isShown);
        sendSamplesBtn.querySelector(".icon").classList.toggle("hide", !isShown);
        sendSamplesBtn.classList.toggle("swatchCheckout__submit--progress", isShown);
    }


    function captureErr(e){
        initProgressBtn(false);
        console.log(e.target)

        e.target.classList.add("form-input-error");
    }


    function fixSwatchColorText(colorText){
        colorText = colorText.split(" - ")[0];
        colorText = colorText.split("(")[0];

        return colorText;
    }



    function removeSwatch(e){
        let $swatch = e.currentTarget,
            swatchIndex = $swatch.getAttribute("id").split("_")[1];

        if( Array.isArray(swatchData.swatch_colors) ){
            swatchData.swatch_colors.splice(swatchIndex, 1);
            swatchData.swatch_images.splice(swatchIndex, 1);

            let swatchString = JSON.stringify(swatchData);
            window.sessionStorage.setItem("TEAK_requestSWatch", swatchString);

        }else{
            swatchData.swatch_colors = "";
            swatchData.swatch_images = "";
        }
        
        if( (Array.isArray(swatchData.swatch_colors) && swatchData.swatch_colors.length === 0) || swatchData.swatch_colors === "" ){
            window.sessionStorage.removeItem("TEAK_requestSWatch");

            sendSamplesBtn.setAttribute("disabled", true);
            document.querySelector(".swatchCheckout__itemEmpty").classList.remove("hide");
        }

        document.getElementById("swatchCheckoutItemList").innerHTML = "";

        parseSwatchData(swatchData);

        e.preventDefault();
    }



    function buildSwatchItem(data, i){
        return [
           '<li class="swatchCheckout__item">',
                '<figure class="swatchCheckout__itemImgCntr">',
                    '<img class="swatchCheckout__itemImg" src="'+ (Array.isArray(data.swatch_images) ? data.swatch_images[i] : data.swatch_images) +'">',
                    '<figcaption class="swatchCheckout__itemTitle">',
                        '<a class="swatchCheckout__productName" href="'+ data.product_url +'">'+ data.product_title +'</a>',
                        '<span class="swatchCheckout__swatchColor">'+ (Array.isArray(data.swatch_colors) ? data.swatch_colors[i] : data.swatch_colors) +'</span>',
                        '<button type="button" class="swatchCheckout__removeItem" id="swatch_'+ i +'">',
                            '<svg class="icon-close" width="15" height="15" viewBox="0 0 15 15" xmlns="http://www.w3.org/2000/svg"><title>close</title><path d="M15 1.73L13.52.25 7.89 5.88 2.26.25.778 1.73l5.63 5.63-5.63 5.63 1.482 1.482 5.63-5.63 5.63 5.63 1.48-1.48-5.63-5.63L15 1.73"></path></svg>',
                        '</button>',
                    '</figcaption>',
                '</figure>',
           '</li>'
        ].join("");
    }


    function postToZendesk(e){
        let $this = $(this);

        cleanUpInputs();

        $.ajax({
            method: $this[0].method,
            url: $this[0].action,
            data: $this.serialize()

        }).done(postProcessSubmission);

        e.preventDefault();
    }


    function cleanUpInputs(){
        formInput.forEach(function(element){
            element.classList.remove("form-input-error");
        });
    }


    function postProcessSubmission(responseData){
        if( responseData.status === "success"){
            document.querySelector(".swatchCheckout--confirmation").classList.toggle("hide");
            document.querySelector(".swatchCheckout--order").classList.toggle("hide");

            window.scrollTo(0, 0);
            window.sessionStorage.removeItem("TEAK_requestSWatch");
            initProgressBtn(true);
        }
    }


}(window, document));
</script>

{{> layout/base}}

